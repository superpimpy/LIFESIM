# ST-LifeSim

SillyTavern 확장 — 채팅 속 일상 시뮬레이터

캐릭터와 문자·통화·SNS·지갑·캘린더·기프티콘 등 다양한 일상 기능을 즐길 수 있는 종합 라이프심 확장입니다.

---

## 기능 목록

| 모듈 | 설명 |
|------|------|
| 📞 통화 | AI 응답 감지 기반 수신 전화, 직접 발신, 부재중 처리, 통화 기록 요약 |
| 📸 SNS | 인스타그램 스타일 피드, NPC 자동 포스팅, 댓글/답글 생성, 카드 접기/펼치기 |
| 📋 연락처 | 채팅·캐릭터별 연락처 관리, AI 프로필 자동 생성 |
| 💰 지갑 | 캐릭터 간 금전 거래 시뮬레이션 |
| 🎁 기프티콘 | 기프티콘 선물·사용 기록 관리 |
| 📅 캘린더 | 일정 등록 및 컨텍스트 주입 |
| 😊 이모티콘 | 이모티콘 전송 패널 |
| 🛠️ 퀵 도구 | 시간 구분선, 읽씹/안읽씹, 사건 발생, 음성/사진 메모 |

---

## 설치

1. SillyTavern의 `public/scripts/extensions/third-party/` 폴더에 `st-lifesim` 폴더 전체를 복사합니다.
2. SillyTavern을 재시작하거나 페이지를 새로고침합니다.
3. 채팅 입력창 옆에 **📱** 버튼이 나타나면 설치 완료입니다.

---

## 주요 기능 설명

### 📞 통화 모듈

- **수신 전화**: AI 응답에서 통화 관련 키워드를 감지하면 자동으로 수신 전화 UI가 나타납니다.
- **선제 통화 (선전화)**: 캐릭터가 먼저 전화를 거는 기능입니다.
  - 설정의 **확률 탭**에서 "먼저 전화를 걸 확률"을 설정하면 유저 메시지 전송 시 설정 확률로 수신 전화가 울립니다.
  - 유저가 **"전화해줘", "전화 줘", "보고싶어", "그리워"** 등의 메시지를 보내면 확률 0%여도 강제로 수신 전화가 트리거됩니다.
- **발신**: 통화 기록 팝업의 발신 버튼으로 직접 전화를 걸 수 있습니다.
- **통화 요약**: 통화 종료 후 AI가 자동으로 통화 내용을 요약합니다.
- **기록 관리**: 통화 기록 확인, 수정, 삭제, 완전삭제(대화 구간 포함), 컨텍스트 포함/제외 설정.

### 📸 SNS 모듈

- 인스타그램 스타일의 피드를 통해 캐릭터·연락처·유저가 게시물을 올릴 수 있습니다.
- **자동 포스팅**: 설정 확률에 따라 유저 메시지 시 NPC가 자동으로 게시물을 생성합니다.
- **댓글 반응**: 유저가 댓글을 달면 NPC가 자동으로 답글을 생성합니다.
- **카드 접기/펼치기**: 각 게시물 카드 헤더의 **▾/▸** 버튼으로 내용을 접어 헤더(프사+아이디)만 표시할 수 있습니다. 접힘 상태는 탭 이동 후에도 유지됩니다.
- **번역**: 각 게시물·댓글에 한글 번역 버튼이 있습니다.
- **프로필 설정**: 각 저자별 아바타, @핸들, 기본 이미지, 언어, 포스팅 활성화 여부를 설정할 수 있습니다.

### ⚙️ 설정 패널

설정은 **⚙️ 설정** 메뉴에서 탭별로 관리합니다.

| 탭 | 내용 |
|----|------|
| ⚙️ 일반 | 전체 활성화, 데이터 백업/복원, 초기화 |
| 🧩 모듈 | 각 모듈별 활성화/비활성화 |
| 🖼️ 이미지 | 이모티콘·이미지 크기, SNS/메신저 이미지 프롬프트, 캐릭터 외관 태그, 통화 사운드/진동 |
| 🎲 확률 | 선톡, SNS 자동 생성, 선전화 확률 설정 |
| 🎨 테마 | UI 색상 커스터마이징, 토스트 색상/위치 |
| 📝 프롬프트 | **기능별 AI 모델 지정**(직접입력 모델 추가), SNS/메시지/통화 프롬프트 소분류 탭 편집 |

#### 📝 프롬프트 탭 — AI 모델 지정

SNS 생성, SNS 번역, 통화 요약, 연락처 AI 생성 각각에 별도 AI 모델을 지정할 수 있습니다.

- **공급자 선택**: OpenAI, Claude, Google AI, OpenRouter, DeepSeek 등에서 선택합니다.
  - 비워두면 현재 SillyTavern 전역 설정(기본 AI)을 사용합니다.
- **모델명 입력**: 선택한 공급자의 모델명을 직접 입력합니다. 플레이스홀더에 예시가 표시됩니다.
  - 비워두면 현재 해당 공급자의 전역 모델 설정을 사용합니다.

예시:
- OpenAI + `gpt-4o-mini` → SNS 생성에 GPT-4o mini 사용
- Claude + `claude-3-5-haiku-latest` → 통화 요약에 Claude Haiku 사용

---

## 데이터 저장

- 모든 데이터는 SillyTavern의 extension settings에 저장됩니다.
- **채팅별 데이터**: 통화 기록 (chat 바인딩)
- **캐릭터별 데이터**: SNS 피드 (character 바인딩)
- **전역 데이터**: 연락처, SNS 프로필, 지갑, 캘린더 등 (chat 또는 character 바인딩, 설정에서 변경 가능)
- **SNS 카드 접힘 상태**: localStorage에 저장되어 세션 간에 유지됩니다.
- 설정 탭의 "데이터 백업/복원" 기능으로 전체 데이터를 JSON 파일로 내보내거나 가져올 수 있습니다.

---

## 주의사항

- SillyTavern의 `generateRaw` / `generateQuietPrompt` API를 사용하므로, AI 생성 기능은 SillyTavern 내부 AI 연결이 필요합니다.
- 각 기능별 AI 모델을 별도로 지정하지 않으면 현재 전역 설정의 AI를 사용합니다.
- 통화 중에는 다른 통화를 시작할 수 없습니다.

---

## 버전

`1.0.0`
